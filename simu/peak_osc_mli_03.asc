Version 4
SHEET 1 2396 1228
WIRE 576 -672 576 -704
WIRE 576 -560 576 -592
WIRE 576 -448 576 -480
WIRE 624 -448 576 -448
WIRE 736 -448 704 -448
WIRE 576 -416 576 -448
WIRE 576 -304 576 -336
WIRE 736 -288 736 -448
WIRE 784 -288 736 -288
WIRE 896 -288 864 -288
WIRE 576 -192 576 -224
WIRE 832 -144 832 -176
WIRE 736 -128 736 -288
WIRE 800 -128 736 -128
WIRE 896 -112 896 -288
WIRE 896 -112 864 -112
WIRE 160 -96 160 -224
WIRE 624 -96 160 -96
WIRE 736 -96 704 -96
WIRE 800 -96 736 -96
WIRE -544 -80 -544 -176
WIRE -352 -64 -480 -64
WIRE 736 -64 736 -96
WIRE 512 -48 512 -80
WIRE 832 -48 832 -80
WIRE -416 -16 -416 -176
WIRE -480 0 -480 -64
WIRE -448 0 -480 0
WIRE 160 0 160 -96
WIRE 256 0 160 0
WIRE 352 0 336 0
WIRE -352 16 -352 -64
WIRE -352 16 -384 16
WIRE -320 16 -352 16
WIRE -544 32 -544 0
WIRE -448 32 -544 32
WIRE -544 64 -544 32
WIRE 512 64 512 32
WIRE 736 64 736 16
WIRE 736 64 512 64
WIRE 48 80 -32 80
WIRE 160 80 160 0
WIRE 160 80 112 80
WIRE 512 96 512 64
WIRE -896 112 -896 -48
WIRE 224 144 224 96
WIRE 960 144 960 -16
WIRE 160 160 160 80
WIRE 192 160 160 160
WIRE 896 160 896 -112
WIRE 928 160 896 160
WIRE 352 176 352 0
WIRE 352 176 256 176
WIRE 1136 176 992 176
WIRE 192 192 160 192
WIRE 928 192 576 192
WIRE -896 208 -896 192
WIRE 512 208 512 176
WIRE -544 224 -544 144
WIRE -416 224 -416 48
WIRE 32 272 0 272
WIRE 160 272 160 192
WIRE 160 272 112 272
WIRE 256 272 160 272
WIRE 352 272 352 176
WIRE 352 272 336 272
WIRE 32 368 0 368
WIRE 160 368 160 272
WIRE 160 368 112 368
WIRE 224 368 224 208
WIRE 960 384 960 208
WIRE -416 512 -416 496
WIRE -896 528 -896 464
WIRE -800 624 -800 576
WIRE 96 720 96 656
WIRE 416 768 160 768
WIRE -896 784 -896 608
WIRE -800 784 -800 704
WIRE 224 816 224 656
WIRE 160 832 160 768
WIRE 192 832 160 832
WIRE 320 848 256 848
WIRE 416 848 416 768
WIRE 416 848 384 848
WIRE 480 848 416 848
WIRE 576 848 576 192
WIRE 576 848 480 848
WIRE 640 848 576 848
WIRE -32 864 -160 864
WIRE 96 864 96 800
WIRE 96 864 32 864
WIRE 192 864 96 864
WIRE 480 896 480 848
WIRE -160 928 -160 864
WIRE 576 928 576 848
WIRE -896 944 -896 912
WIRE -160 1056 -160 1008
WIRE 224 1056 224 880
WIRE 480 1056 480 960
WIRE 480 1056 448 1056
WIRE 576 1056 576 1008
WIRE 576 1056 480 1056
WIRE -896 1072 -896 1024
FLAG -896 208 0
FLAG 224 368 0
FLAG 224 96 VCC
FLAG -320 16 VREF
FLAG -32 80 0
FLAG 960 384 0
FLAG 960 -16 VCC
FLAG -416 512 0
FLAG 224 1056 0
FLAG 224 656 VCC
FLAG 96 656 VREF
FLAG -160 1056 0
FLAG -896 784 0
FLAG -800 784 0
FLAG -896 1072 0
FLAG -896 464 vmod
FLAG -800 576 venv
FLAG -896 912 v_sin
FLAG 448 1056 VREF
FLAG -896 -48 VCC
FLAG -416 224 0
FLAG -416 -176 VCC
FLAG -544 224 0
FLAG -544 -176 VCC
FLAG 1136 176 pwm_out
FLAG 640 848 peak
FLAG 0 272 vcc
FLAG 0 368 0
FLAG 832 -48 0
FLAG 832 -176 VCC
FLAG 160 -224 tri_wave
FLAG 576 -192 0
FLAG 576 -704 VCC
FLAG 512 -80 VCC
FLAG 512 208 0
SYMBOL res 128 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL cap 112 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL voltage -896 96 R0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -416 400 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value PWL(0 0 0.5 12)
SYMBOL Opamps\\UniversalOpamp2 224 848 R0
SYMATTR InstName U3
SYMBOL diode 320 864 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMBOL cap 496 960 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 220n
SYMBOL cap -32 880 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 112 816 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL bv -160 912 R0
SYMATTR InstName B1
SYMATTR Value V=V(venv)*V(v_sin)
SYMBOL voltage -800 608 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value PWL(0 0 0.2 1)
SYMBOL voltage -896 512 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value SINE(0 2 500)
SYMBOL bv -896 928 R0
SYMATTR InstName B2
SYMATTR Value V=V(vmod)*V(venv)
SYMBOL res 352 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 2.7k
SYMBOL res 592 1024 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 352 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL Opamps\\UniversalOpamp2 -416 16 R0
SYMATTR InstName U4
SYMBOL res -560 -96 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res -560 48 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL Opamps\\UniversalOpamp2 224 176 R0
SYMATTR InstName U1
SYMBOL Opamps\\UniversalOpamp2 960 176 R0
SYMATTR InstName U5
SYMBOL res 128 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL Opamps\\UniversalOpamp2 832 -112 R0
SYMATTR InstName U2
SYMBOL res 720 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 880 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 720 -80 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 720 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 592 -576 M0
SYMATTR InstName R13
SYMATTR Value R=100k*(1-THRESHOLD)
SYMBOL res 592 -432 M0
SYMATTR InstName R14
SYMATTR Value R=100k*THRESHOLD
SYMBOL res 560 -320 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 560 -688 R0
SYMATTR InstName R16
SYMATTR Value 22k
SYMBOL res 496 -64 R0
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 496 80 R0
SYMATTR InstName R18
SYMATTR Value 10k
TEXT 1288 312 Left 2 !.tran 200m startup
TEXT 688 504 Left 2 ;Signal d'entrée à 2Vpp max.\nVitesse min défini par R3, 100k max, plus on descend plus la vitesse min est élevée.\nAu-dessus de 100k, pas de vitesse min, le seuil remonte.
TEXT 872 -624 Left 2 !.param THRESHOLD 0.01
